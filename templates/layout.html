<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <title>The Guess Who?</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/normalize.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/skeleton.css') }}">

  <!-- JS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script
src="https://code.jquery.com/jquery-3.1.1.slim.min.js"
integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc="
crossorigin="anonymous"></script>
  <script scr="{{ url_for('static', filename='app.js') }}"></script>
  <script>
  $(function(){
  // jquery code here
    $('form').submit(function(e){
      dm.understand($(this).find("#clue")[0].value);
      e.preventDefault();
      return false;
    })
  }())

  let dm = function() {
    let $dm = this;

    this.status = {
      "clues": [],
      "": [],
    };

    this.understand = function(text) {
      // understand text and update status
      // parse text? no parsing?
      $dm.control(text)
    }

    this.generate = function() {
      // generate text based on status.

      return
    }

    this.control = function(text) {
      $.ajax({
          // The URL for the request
          url: "/game/i/update",

          // The data to send (will be converted to a query string)
          data: {
              clue: text
          },

          // Whether this is a POST or GET request
          type: "POST",

          // The type of data we expect back
          dataType : "json",
      })
        // Code to run if the request succeeds (is done);
        // The response is passed to the function
        .done(function(json) {
           $("#status").html(json);
        })
        // Code to run if the request fails; the raw request and
        // status codes are passed to the function
        .fail(function( xhr, status, errorThrown ) {
          console.log( "Error: " + errorThrown );
          console.log( "Status: " + status );
          console.dir( xhr );
        })
        // Code to run regardless of success or failure;
        .always(function( xhr, status ) {
          alert( "The request is complete!" );
        });  }
  }
  </script>

</head>
<body>
<div class="container">

  <div class="row">
    username: {{ username }}
    <a href="{{ url_for('quit') }}">quit</a>
  </div>

  <div class="row">
    <form method="GET">
      <label for="clue">Give me a clue:</label>
      <input name="clue" class="u-full-width" type="text" id="clue">
    </form>
  </div>

  <div class="row" id="interface">

  </div>
  <pre><code id="status"></code></pre>
</div>
</body>
</html>
